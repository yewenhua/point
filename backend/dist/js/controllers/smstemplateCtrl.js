angular.module("app").controller("SmsTemplateCtrl",["$scope","DataLoad","toaster",function(t,e,a){t.templateList=[],t.template={},t.template.name="",t.template.content="",t.template.type="",t.template.isNew=!0,t.loading=!0,t.editTemplate=function(e){t.template=angular.copy(e),t.updateTemplate()},t.updateTemplate=function(){var p=e.updateTemplate({id:t.template.isNew?"":t.template.id,type:t.template.type,content:t.template.content,name:t.template.name});return p.then(function(e){e&&0==e.code?(t.getAllData(),a.pop("success","短信模板","更新成功！")):a.pop("error","短信模板",e.message)},function(){a.pop("error","短信模板","更新出错！")})},t.switch_status=function(t){if(t.open)var p=1;else var p=0;var n=e.switchTemplateStatus({id:t.id,status:p});return n.then(function(t){t&&0==t.code?a.pop("success","短信模板",t.message):a.pop("error","短信模板",t.message)},function(){a.pop("error","短信模板","修改出错")})},t.getAllData=function(){t.loading=!0;var p=e.smsTemplate({});return p.then(function(e){t.loading=!1,e&&0==e.code?0!=e.data.length?(t.templateList=e.data,angular.forEach(t.templateList,function(t,e){var a=angular.copy(t.status);t.open=1==a})):(t.templateList=[],a.pop("success"," 短信模板","没有数据！")):(t.templateList=[],a.pop("error"," 短信模板",e.message))},function(){t.loading=!1,t.templateList=[],a.pop("error"," 短信模板"," 获取短信模板出错！")})},t.getAllData()}]);